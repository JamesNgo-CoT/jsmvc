"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function collectionFactory(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.definedByEventfulPropertyDescriptors||Object.defineProperties(t,eventfulPropertyDescriptors),t.definedByCollectionPropertyDescriptors||Object.defineProperties(t,collectionPropertyDescriptors),t.push.apply(t,_toConsumableArray(e)),t}var cf=collectionFactory,collectionPropertyDescriptors={definedByCollectionPropertyDescriptors:{value:!0},__collectionData:{writable:!0},length:{get:function(){return this.__collectionData?this.__collectionData.length:0}},finalizeData:{value:function(e){for(var t=this;e!==this.length;)e<this.length?function(){var r=String(e);Object.defineProperty(t,r,{configurable:!0,enumerable:!0,get:function(){return this.__collectionData[r]},set:function(e){if(this.__collectionData[r]!==e){var t=this.__collectionData[r];this.__collectionData[r]=e,this.definedByEventfulPropertyDescriptors&&(this.trigger("change",r,e,t),this.trigger("change:".concat(r),e,t))}}}),e++}():(delete this[String(e-1)],e--)}},toArray:{value:function(){return this.__collectionData.slice()}}};["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].forEach(function(a){collectionPropertyDescriptors[a]={value:function(){var e;this.__collectionData||(this.__collectionData=[]);for(var t=this.length,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(e=Array.prototype[a]).call.apply(e,[this.__collectionData].concat(n));return this.finalizeData(t),this.trigger("change"),o}}}),["concat","includes","indexOf","join","lastIndexOf","slice","toSource","toString","toLocaleString","entries","every","filter","find","findIndex","forEach","keys","map","reduce","reduceRight","some","values"].forEach(function(i){collectionPropertyDescriptors[i]={value:function(){var e;this.__collectionData||(this.__collectionData=[]);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=Array.prototype[i]).call.apply(e,[this.__collectionData].concat(r))}}});var eventfulPropertyDescriptors={definedByEventfulPropertyDescriptors:{value:!0},__eventData:{writable:!0},__eventReferences:{writable:!0},on:{value:function(e,t,r,n){var i=this,o=2<arguments.length&&void 0!==r&&r,a=3<arguments.length&&void 0!==n?n:this,s={name:e,handler:t,once:o,context:a};return this.addEventListener&&(s.listener=o?function(){t.apply(void 0,arguments),i.off(e,t,o,a,{calledFromListener:!0})}:t,this.addEventListener(e,s.listener,{once:o})),this.__eventData||(this.__eventData=[]),this.__eventData.push(s),a&&a!==this&&a.definedByEventfulPropertyDescriptors&&(a.__eventReferences||(a.__eventReferences=[]),a.__eventReferences.push({emitter:this,eventData:s})),this}},off:{value:function(e,t,r,n,i){var o=4<arguments.length&&void 0!==i?i:{};if(!this.__eventData)return this;for(var a=0;a<this.__eventData.length;){var s=this.__eventData[a];if(null!=e&&e!==s.name||null!=t&&t!==s.handler||null!=r&&r!==s.once||null!=n&&n!==s.context)a++;else if(this.removeEventListener&&!o.calledFromListener&&this.removeEventListener(s.name,s.listener),this.__eventData.splice(a,1),n&&n!==this&&n.definedByEventfulPropertyDescriptors&&n.__eventReferences)for(var l=0;l>n.__eventReferences.length;){var c=n.__eventReferences[l];c.emitter===this&&c.eventData===s?n.__eventReferences.splice(l,1):l++}}return this}},trigger:{value:function(r){for(var e=arguments.length,n=new Array(1<e?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return this.__eventData&&(this.__eventData.forEach(function(e){var t;r===e.name&&(t=e.handler).call.apply(t,[e.context].concat(n))}),this.off(r,null,!0,null)),this}},removeEventReferences:{value:function(a,s){return this.__eventReferences&&Array.from(this.__eventReferences).forEach(function(e){if(!(null!=a&&a!==e.emitter||null!=s&&s!==e.eventData)){var t=e.eventData,r=t.name,n=t.handler,i=t.once,o=t.context;e.emitter.off(r,n,i,o)}}),this}}};function modelFactory(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(var t in e.definedByEventfulPropertyDescriptors||Object.defineProperties(e,eventfulPropertyDescriptors),e.definedByModelPropertyDescriptors||Object.defineProperties(e,modelPropertyDescriptors),e){var r=Object.getOwnPropertyDescriptor(e,t);r.get||r.set||e.property(t)}return e}var mf=modelFactory,modelPropertyDescriptors={definedByModelPropertyDescriptors:{value:!0},__propertyData:{writable:!0},property:{value:function(n,e,t,r){var i=1<arguments.length&&void 0!==e?e:this[n],o=2<arguments.length&&void 0!==t?t:function(e){return e()},a=3<arguments.length&&void 0!==r?r:function(e,t){t()};this.__propertyData||(this.__propertyData={}),void 0!==i&&(this.__propertyData[n]=i),delete this[n],Object.defineProperty(this,n,{configurable:!0,enumerable:!0,get:function(){var e=this;return o.call(this,function(){return e.__propertyData[n]})},set:function(e){var t=this;if(this.__propertyData[n]!==e){var r=this.__propertyData[n];a.call(this,e,function(){t.__propertyData[n]=e}),this.definedByEventfulPropertyDescriptors&&(this.trigger("change",n,e,r),this.trigger("change:".concat(n),e,r))}}})}},unproperty:{value:function(e){var t=this.__propertyData[e];delete this.__propertyData[e],delete this[e],void 0!==t&&(this[e]=t)}},toJSON:{value:function(){return Object.assign({},this.__propertyData)}}};function viewFactory(e,t,r,n){if("string"==typeof e&&(e=document.createElement(e)),e.definedByEventfulPropertyDescriptors||Object.defineProperties(e,eventfulPropertyDescriptors),e.hasAttributes())for(var i=0,o=e.attributes.length;i<o;i++){var a=e.attributes[i],s=a.name,l=a.value;(t="object"===_typeof(t)&&null!==t?Object.assign({},t):null==t?{}:{"original attributes":t})[s]=l}if(e.firstChild){for(var c,f=[],u=0,h=e.childNodes.length;u<h;u++)f.push(e.childNodes[u]);if(0<f.length)(c=r=Array.isArray(r)?r.slice():null==r?[]:[r]).unshift.apply(c,f)}return e.definedByViewPropertyDescriptors||Object.defineProperties(e,viewPropertyDescriptors),e.setAttributes(t).setChildElements(r).render(n,!0)}["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","viewFactoryl","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"].forEach(function(n){viewFactory[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return viewFactory.apply(void 0,[n].concat(t))}});var vf=viewFactory,viewPropertyDescriptors={definedByViewPropertyDescriptors:{value:!0},__attributes:{writable:!0},setAttributes:{value:function(e){return this.__attributes=e,this}},__childElements:{writable:!0},setChildElements:{value:function(e){return this.__childElements=e,this}},promise:{writable:!0},render:{value:function(e,t){var a=this,r=1<arguments.length&&void 0!==t&&t;if(this.hasAttributes()){for(var n=[],i=0,o=this.attributes.length;i<o;i++)n.push(this.attributes[i].name);n.forEach(function(e){a.removeAttribute(e)})}for(;this.firstChild;)this.removeChild(this.firstChild);function s(e,t){if(t=t||a.appendChild(document.createElement("span")),Array.isArray(e))return t.parentNode.removeChild(t),l(e);if("function"==typeof e)return s(e(a),t);if(e instanceof Promise)return e.then(function(e){return s(e,t)});var r;if(e instanceof HTMLElement||e instanceof Text)t.parentNode.insertBefore(e,t),e.definedByViewPropertyDescriptors&&(r=e.promise);else if("string"==typeof e){var n=document.createElement("div");for(n.innerHTML=e;n.firstChild;)t.parentNode.insertBefore(n.firstChild,t)}return t.parentNode.removeChild(t),r}var l=function t(e){return"function"==typeof e?t(e(a)):e instanceof Promise?e.then(function(e){return t(e)}):e instanceof HTMLElement?s(e):Array.isArray(e)?Promise.all(e.map(function(e){return s(e)})):null!=e?t([e]):void 0};return this.promise=Promise.all([function r(n,t){if(null==n||!1===n)return n;if(Array.isArray(n)){var i=[];return n.forEach(function(e,t){n[t]=r(e),n[t]instanceof Promise&&i.push(n[t].then(function(e){n[t]=e}))}),0<i.length?Promise.all(i).then(function(){return r(n.join(" "),t)}):r(n.join(" "),t)}if(n instanceof Promise)return console.log("PROMISE"),n.then(function(e){return console.log("DONE",e,t),r(e,t)});if("object"!==_typeof(n))return"function"==typeof n?r(n(),t):("boolean"==typeof n?r("",t):t&&(console.log("SET ATTRIBUTE",t,n),a.setAttribute(t,n)),n);var e=[];for(var o in n)e.push(r(n[o],o));return Promise.all(e)}(this.__attributes),l(this.__childElements)]).then(function(){var t=[];return!r&&a.__childElements&&Array.isArray(a.__childElements)&&a.__childElements.forEach(function(e){e.definedByViewPropertyDescriptors&&t.push(e.render().promise)}),Promise.all(t)}).then(function(){if(e)return e=Array.isArray(e)?e:[e],Promise.all(e.map(function(e){return e(a)}))}).then(function(){return a}),this}}};